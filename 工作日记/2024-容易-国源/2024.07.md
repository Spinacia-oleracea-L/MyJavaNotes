# 第一周

## 7.01 周一 阴转中雨

### TODO：

1. 邵逸夫-院内接口问题处理
2. 台州医院-登记管理-信息登记-校验-院内接口：知情同意书同步

## 7.02 周二 大雨

### TODO：

1. 毓璜顶漏洞修复、方案寻找
   * ICMP  timestamp请求响应漏洞
   * 允许Traceroute探测漏洞
   * nginx  缓冲区错误漏洞(CVE-2022-41741)
   * nginx  越界写入漏洞（CVE-2022-41742）
   * Elasticsearch 未授权访问【原理扫描】
2. 存储板样本库宕机重启
3. 台州项目更新
4. 邵逸夫-登记管理/信息登记/新增样本-组织耗材类型更改

### 收获：

1. 毓璜顶开发：admin admin123

## 7.03 周三 多云

### TODO：

1. 台州医院-信息登记-知情同意书，部署后发现与postman请求院内接口返回的xml不同；线上日志看来，返回了json格式数据
2. VM CentOS 7 模拟漏洞修复
   * ICMP  timestamp请求响应漏洞
   * 允许Traceroute探测漏洞
3. 毓璜顶漏洞修复、方案寻找
   * Elasticsearch 不受控制的资源消耗（CVE-2023-31418）选取方案为升级到 Elasticsearch 版本 7.17.13 

## 7.04 周四 晴

### TODO：

1. VM CentOS 7 模拟漏洞修复
   * nginx  缓冲区错误漏洞(CVE-2022-41741)
   * nginx  越界写入漏洞（CVE-2022-41742）选择升级nginx版本nginx-1.23.4

## 7.05 周五 晴转大雨

### TODO：

1. VM CentOS 7 模拟漏洞修复
   *  升级Elasticsearch 版本 7.17.13 版本测试
   *  ElasticSearch 数据库开启授权认证
2. 毓璜顶漏洞修复、方案寻找
   * 可通过HTTP获取远端WWW服务信息

## 7.06 周六 多云

### TODO：

1. VM CentOS 7 模拟漏洞修复
   * 可通过HTTP获取远端WWW服务信息

# 第二周

## 7.08 周一 多云

### TODO：

1. VM CentOS 7 模拟漏洞修复
   * iptables 白名单设置，保证项目端口运行

2. 待医院下班后进行邵逸夫的版本更新

## 7.09 周二 阴

### TODO：

1. 邵逸夫检索-术前治疗、乙肝情况-检索列失效
2. 汇总漏洞整治方案文档

## 7.10 周三 多云

### TODO：

1. 毓璜顶样本出库单管理-提交报错-线上问题处理
1. 邵逸夫-登记列表-任务列表-任务完成后状态未更新-数据运维
1. 邵逸夫-信息登记-his刷新时保存名称、身份证号、出生日期、住址、电话字段等脱敏字段
1. 待医院下班后，修复毓璜顶安全漏洞

## 7.11 周四 晴

### TODO：

1. 毓璜顶ElasticSearchConfig，增加密码验证
1. 下班后，开启毓璜顶ElasticSearch密码
1. 邵逸夫-前、后清场老数据运维修改

### 总结：

1. 毓璜顶漏洞修复主要升级了nginx至1.23.4
2. 修复了nginx的请求头泄露server问题，使用补丁headers-more-nginx-module-0.34.tar
3. 升级了elasticsearch至7.17.13
4. 设置elasticsearch密码验证

## 7.12 周五 阴

### TODO：

1. 杭州妇产-线上医嘱名称修改
1. 杭州妇产-数据运维-入库申请单-详情修改样本容量

## 收获：

1. idea快捷键ctrl + w，智能选区

2. 在使用Java 8中的Stream流和Lambda表达式时，通常不会比传统的for循环和forEach方式效率更低。实际上，使用Stream流和Lambda表达式可以提高代码的可读性和简洁性，同时利用并行处理提高性能。

   Stream流和Lambda表达式的内部实现会利用一些优化技术，例如惰性求值、短路操作、并行处理等，以提高性能。在某些情况下，Stream流甚至可以比传统的循环方式更高效，特别是在处理大量数据时。

   然而，在某些特定的情况下，如果使用不当，Stream流可能会比传统的循环方式效率略低。因此，在一些对性能要求极高的场景下，您可以根据具体情况选择合适的方法来处理数据。综合来说，Stream流和Lambda表达式的性能问题通常不是应该过分担心的主要问题，重点应该放在代码的可维护性和可读性上。

## 7.13 周六 多云

### TODO：

1. 线上邵逸夫版本更新

# 第三周

## 7.15 周一 多云转小雨

### TODO：

1. 单点登录测试-CDMO生产管理系统/账号模块
   * CDMO-未登录页签刷新后，会将登录页签的账号登出
   * 物料-菜单管理、角色管理无法读取菜单数据

## 7.16 周二 小雨

### TODO：

1. 单点登录测试-CDMO生产管理系统/样本制备、入库存储模块
   * CDMO-入库单管理，已出库的样本状态显示错误
2. 邵逸夫-his刷新时保存敏感字段，即使his返回为null，强制保存
3. 台州医院bug修复-深低温存储管理-异常结束的操作单手动结束

### 收获：

1. `mybatisPlus`使用`wrapper`进行数据字段的组装时，即使数据为`null`，也会进行存储

   ```java
   		// 点击刷新时，更新报错脱敏信息
   		HisPcaseInfo pcaseInfo = new HisPcaseInfo();
   		pcaseInfo.setPname(pcase.getPname());
   		pcaseInfo.setPcid(pcase.getPcid());
   		pcaseInfo.setPbirthday(pcase.getPbirthday());
   		pcaseInfo.setPaddress(pcase.getPaddress());
   		pcaseInfo.setPphone(pcase.getPphone());
   		this.update(pcaseInfo, Wrappers.<HisPcaseInfo>lambdaQuery().eq(HisPcaseInfo::getId, hisPcaseInfo.getId()));
   
   
   		// 点击刷新时，更新报错脱敏信息，即使his返回为null，强制保存
   		UpdateWrapper<HisPcaseInfo> updateWrapper = new UpdateWrapper<>();
   		updateWrapper.eq("id", hisPcaseInfo.getId())
   				.set("pname", pcase.getPname())
   				.set("pcid", pcase.getPcid())
   				.set("pbirthday", pcase.getPbirthday())
   				.set("paddress", pcase.getPaddress())
   				.set("pphone", pcase.getPphone());
   		this.update(updateWrapper);
   ```

## 7.17 周三 阴

### TODO：

1. 单点登录测试-CDMO生产管理系统/物料系统模块
   * 用管理员账号授权新用户权限，列表中无新用户信息

## 7.18 周四 阴

### TODO：

1. 线上问题邵逸夫-液体样本接收-无法接收。
   * 查询代码逻辑-通过标本条形码查询医嘱信息
   * 处理线上错误数据
2. 邵逸夫-登记管理-核对列表-同源样本的批量修改，存在异常-已存在检查报告,无法进行批次修改
3. 线上问题杭州妇产科-工单管理-临时工单-检查信息院内接口
4. 线上问题-邵逸夫-登记管理-已接受列表，医嘱流水号为空问题

## 7.19 周五 多云

### TODO：

1. 线上问题-邵逸夫-登记管理-医嘱流水号为空，日志打印设置

   ```json
   # http://localhost:8080/collect/transmitorder/newTransmitOrder
   
   {
     "orderNo": "ZYJJD20240720001",
     "receiveBy": "张陆敏",
     "temperature": "-80℃",
     "receiveLocation": "一号楼",
     "beforeState": "冷藏",
     "receiveTime": "2024-07-20 09:35:27",
     "infos": [
       {
         "sourceType": "2",
         "evaluation": "合格",
         "operName": "航内辅辅荧航治癌",
         "pdiagnose": "咽病",
         "barCode": "504718896039",
         "advContent": "组织医嘱",
         "researchProjectId": null,
         "sdrName": "雷刚",
         "ctName": "王娟",
         "startTime": "2024-07-20 09:34:14",
         "advType": "1",
         "remark": "",
         "id": "866976299833360384",
         "tempId": "1814473493703921666",
         "mrn": "20240719165148916",
         "orderNo": "866976299841748992",
         "hoscode": "A001",
         "hosname": "庆春院区",
         "deptin": "69",
         "deptinName": "肿瘤外科",
         "advCode": "PTH16.02",
         "orderFlag": "PTH",
         "orderFlagName": null,
         "validDay": 14,
         "endTime": "2024-08-03 09:34:14",
         "series": 6,
         "cbNum": 1,
         "dateLtsj": "2024-07-20 09:34:18",
         "patientName": "龚丽",
         "tysdm": "4042462",
         "sjbw": "咽",
         "receiveNFCause": null,
         "inVitroTime": "2017-12-25 15:10:25",
         "allocationTime": "1971-01-10 18:02:13",
         "transferBy": "马秀兰"
       },
       {
         "sourceType": "2",
         "evaluation": "合格",
         "operName": "腺根导助航治辅光光根航癌治根内光甲",
         "pdiagnose": "胃病",
         "barCode": "011289716963",
         "advContent": "组织医嘱",
         "researchProjectId": null,
         "sdrName": "宋强",
         "ctName": "戴霞",
         "startTime": "2024-07-20 09:33:57",
         "advType": "1",
         "remark": "",
         "id": "866976230056919040",
         "tempId": "1814473702416683009",
         "mrn": "20240719165148642",
         "orderNo": "866976230069501952",
         "hoscode": "A001",
         "hosname": "庆春院区",
         "deptin": "01",
         "deptinName": "入院准备中心",
         "advCode": "PTH16.02",
         "orderFlag": "PTH",
         "orderFlagName": null,
         "validDay": 14,
         "endTime": "2024-08-03 09:33:57",
         "series": 1,
         "cbNum": 1,
         "dateLtsj": "2024-07-20 09:34:01",
         "patientName": "黎敏",
         "tysdm": "4042462",
         "sjbw": "胃",
         "receiveNFCause": null,
         "inVitroTime": "2024-06-14 06:46:51",
         "allocationTime": "2016-10-10 17:51:27",
         "transferBy": "董涛"
       }
     ],
     "orderType": 2
   }
   ```

   

## 7.20 周六 小雨

### TODO：

1. 线上问题-邵逸夫-登记管理-医嘱流水号为空-api并发调用测试
1. 邵逸夫项目更新

# 第四周

## 7.22 周一 小雨

### TODO：

1. 邵逸夫-查询优化项目查看

## 7.23 周二 多云

### TODO：

1. 邵逸夫-存储管理/转移列表/导出样本信息，导出文件存在重复数据

## 7.24 周三 多云

### TODO：

1. 邵逸夫-存储管理/样本检索ES/导出样本信息，redis反序列化失败

1. 线上邵逸夫更新

   ```java
   /**
    * 获取数据Map
    *
    * @param mapName
    * @return
    */
   public Map<String, Object> getMapValue(String mapName) {
       HashOperations<String, String, Object> hps = this.redisTemplate.opsForHash();
       try {
           return hps.entries(mapName);
       } catch (Exception e) {
           // 记录错误日志
           log.info("Redis根据名称{}获取数据Map报错: " + e.getMessage(), mapName);
           // 刷新redis缓存
           this.refreshRedis();
           throw e;
       }
   }
   ```
   
   ```java
   // 替换 JDK 默认序列化
   import org.springframework.context.annotation.Bean;
   import org.springframework.context.annotation.Configuration;
   import org.springframework.data.redis.connection.RedisConnectionFactory;
   import org.springframework.data.redis.core.RedisTemplate;
   import org.springframework.data.redis.serializer.GenericJackson2JsonRedisSerializer;
   import org.springframework.data.redis.serializer.StringRedisSerializer;
   
   @Configuration
   public class RedisConfig {
   
       @Bean
       public RedisTemplate<String, Object> redisTemplate(RedisConnectionFactory redisConnectionFactory) {
           RedisTemplate<String, Object> template = new RedisTemplate<>();
           template.setConnectionFactory(redisConnectionFactory);
           template.setKeySerializer(new StringRedisSerializer());
           template.setValueSerializer(new GenericJackson2JsonRedisSerializer());
           template.setHashKeySerializer(new StringRedisSerializer());
           template.setHashValueSerializer(new GenericJackson2JsonRedisSerializer());
           return template;
       }
   }
   ```
   

### 收获：

1. Objects stored in session were serialized by previous version of the app. When new application was deployed some classes changed signatures and now deserializer is unable to unwrap due to conflicted versions.

   The best way is to tell deserializer to igonre this value by providing `springSessionDefaultRedisSerializer` which will output null value:

   ```java
   @Configuration
   public class RedisConfig implements BeanClassLoaderAware {
       
       private ClassLoader classLoader;
   
       @Bean("springSessionDefaultRedisSerializer")
       public RedisSerializer<Object> getRedisSerializer() {
           return new JdkSerializationRedisSerializer(classLoader) {
               @Override
               public Object deserialize(@Nullable byte[] bytes) {
                   try {
                       return super.deserialize(bytes);
                   } catch (SerializationException ex) {
                       log.warn(ex.getMessage());
                   }
                   return null;
               }
           };
       }
       
       @Override
       public void setBeanClassLoader(@NotNull ClassLoader classLoader) {
           this.classLoader = classLoader;
       }
   }
   
   // https://stackoverflow.com/questions/38695886/cannot-deserialize-nested-exception-is-org-springframework-core-serializer-supp
   ```

## 7.25 周四 阴转小雨

### TODO：

1. 毓璜顶-护士站接口报错问题-nacos心跳中断
1. 邵逸夫-整版扫描 /scanner/scannerDebug-扫描仪Connection refused
1. 台州-存储管理-样本检索-大量数据导出超时问题

## 7.26 周五 小雨转晴

### TODO：

1. 会议-8月工作内容安排

## 7.27 周六 小雨

### TODO：

1. 月末汇报会议
1. 杭州妇产项目更新
1. 邵逸夫项目更新

# 第五周

## 7.29 周一 阴转多云

### TODO：

1. 研发实验室管理登录系统测试
1. 台州线上问题处理，新增病例时出现序列化报错。经排查是院内接口报错
1. 邵逸夫群内问题-慢查询排查
   * 接受管理\样本接受\组织接收\条形码回车
   * 登记管理\已接收列表\列表查询慢
1. 公司测试服务器198项目启动异常
   * 198服务器：root zp123

## 7.30 周二 晴

### TODO：

1. 研发实验室-研发生产子系统流程测试

2. 邵逸夫-登记管理/已接收列表中选则采集管后点信息录入速度很慢

   * 慢请求：http://10.90.12.198/surgical/advicerecord/queryAdviceRecordByBarList
   * [ "897493369171"]
   * 慢请求：http://10.90.12.198/surgical/hispcase/queryDonorInfoByMrnAndSeriesList
   * [ { "mrn": "20240719010000323", "series": 7 } ]
   * 慢请求：http://10.90.12.198/collect/preparatsample/receiveSampleInfoByBarCode
   * { "mrn": "20240719010000323", "barCodeList": [ "897493369171" ]}

   * ```bash
     2024-07-30 15:15:39,118 [XNIO-1 task-197] INFO  [c.g.b.c.s.i.PreparatSampleTransmitInfoServiceImpl] PreparatSampleTransmitInfoServiceImpl.java:226 - [已接收列表]：组装医嘱排序信息：Start
     2024-07-30 15:15:39,120 [XNIO-1 task-197] INFO  [c.g.b.c.t.t.s.f.TransactionRestTemplateInterceptor] TransactionRestTemplateInterceptor.java:40 - LCN-SpringCloud TxGroup info -> groupId:null
     2024-07-30 15:15:41,738 [XNIO-1 task-197] INFO  [c.g.b.c.s.i.PreparatSampleTransmitInfoServiceImpl] PreparatSampleTransmitInfoServiceImpl.java:233 - [已接收列表]：组装医嘱排序信息：End,耗时:2619
     2024-07-30 15:15:44,518 [XNIO-1 task-219] INFO  [c.g.b.c.s.impl.SampleComprehensiveServiceImpl] SampleComprehensiveServiceImpl.java:277 - 校验信息更新开始
     2024-07-30 15:15:44,567 [XNIO-1 task-219] INFO  [c.g.b.s.service.impl.ElasticSearchServiceImpl] ElasticSearchServiceImpl.java:134 - 删除es样本 : {"took":23,"errors":false,"items":[{"delete":{"_index":"samples_info_syf_prod","_type":"_doc","_id":"861579417074270208","_version":12,"result":"deleted","forced_refresh":true,"_shards":{"total":1,"successful":1,"failed":0},"_seq_no":838693,"_primary_term":1,"status":200}},{"delete":{"_index":"samples_info_syf_prod","_type":"_doc","_id":"861579417082658816","_version":12,"result":"deleted","forced_refresh":true,"_shards":{"total":1,"successful":1,"failed":0},"_seq_no":838694,"_primary_term":1,"status":200}},{"delete":{"_index":"samples_info_syf_prod","_type":"_doc","_id":"861579417091047424","_version":12,"result":"deleted","forced_refresh":true,"_shards":{"total":1,"successful":1,"failed":0},"_seq_no":838695,"_primary_term":1,"status":200}},{"delete":{"_index":"samples_info_syf_prod","_type":"_doc","_id":"861579417095241728","_version":12,"result":"deleted","forced_refresh":true,"_shards":{"total":1,"successful":1,"failed":0},"_seq_no":838696,"_primary_term":1,"status":200}},{"delete":{"_index":"samples_info_syf_prod","_type":"_doc","_id":"861579648612433920","_version":12,"result":"deleted","forced_refresh":true,"_shards":{"total":1,"successful":1,"failed":0},"_seq_no":838697,"_primary_term":1,"status":200}},{"delete":{"_index":"samples_info_syf_prod","_type":"_doc","_id":"861579648616628224","_version":12,"result":"deleted","forced_refresh":true,"_shards":{"total":1,"successful":1,"failed":0},"_seq_no":838698,"_primary_term":1,"status":200}},{"delete":{"_index":"samples_info_syf_prod","_type":"_doc","_id":"861579648625016832","_version":12,"result":"deleted","forced_refresh":true,"_shards":{"total":1,"successful":1,"failed":0},"_seq_no":838699,"_primary_term":1,"status":200}},{"delete":{"_index":"samples_info_syf_prod","_type":"_doc","_id":"861579648633405440","_version":12,"result":"deleted","forced_refresh":true,"_shards":{"total":1,"successful":1,"failed":0},"_seq_no":838700,"_primary_term":1,"status":200}},{"delete":{"_index":"samples_info_syf_prod","_type":"_doc","_id":"861579683517431808","_version":12,"result":"deleted","forced_refresh":true,"_shards":{"total":1,"successful":1,"failed":0},"_seq_no":838701,"_primary_term":1,"status":200}},{"delete":{"_index":"samples_info_syf_prod","_type":"_doc","_id":"861579726345469952","_version":12,"result":"deleted","forced_refresh":true,"_shards":{"total":1,"successful":1,"failed":0},"_seq_no":838702,"_primary_term":1,"status":200}},{"delete":{"_index":"samples_info_syf_prod","_type":"_doc","_id":"861579726358052864","_version":12,"result":"deleted","forced_refresh":true,"_shards":{"total":1,"successful":1,"failed":0},"_seq_no":838703,"_primary_term":1,"status":200}},{"delete":{"_index":"samples_info_syf_prod","_type":"_doc","_id":"861579726362247168","_version":12,"result":"deleted","forced_refresh":true,"_shards":{"total":1,"successful":1,"failed":0},"_seq_no":838704,"_primary_term":1,"status":200}},{"delete":{"_index":"samples_info_syf_prod","_type":"_doc","_id":"861579726370635776","_version":12,"result":"deleted","forced_refresh":true,"_shards":{"total":1,"successful":1,"failed":0},"_seq_no":838705,"_primary_term":1,"status":200}}]}
     2024-07-30 15:15:44,612 [XNIO-1 task-219] INFO  [c.g.b.c.s.impl.SampleComprehensiveServiceImpl] SampleComprehensiveServiceImpl.java:448 - 保存ES返回信息 : {"took":39,"errors":false}
     2024-07-30 15:15:44,612 [XNIO-1 task-219] INFO  [c.g.b.c.s.impl.SampleComprehensiveServiceImpl] SampleComprehensiveServiceImpl.java:455 - 校验信息更新完成
     2024-07-30 15:15:44,675 [XNIO-1 task-212] INFO  [c.g.b.c.t.t.s.f.TransactionRestTemplateInterceptor] TransactionRestTemplateInterceptor.java:40 - LCN-SpringCloud TxGroup info -> groupId:null
     
     
     
     2024-07-30 15:15:55,204 [XNIO-1 task-195] INFO  [c.g.b.collect.service.impl.DonorInfoServiceImpl] DonorInfoServiceImpl.java:474 - 查询患者是否存在耗时：86,患者信息：null
     2024-07-30 15:15:55,207 [XNIO-1 task-195] INFO  [c.g.b.c.t.t.s.f.TransactionRestTemplateInterceptor] TransactionRestTemplateInterceptor.java:40 - LCN-SpringCloud TxGroup info -> groupId:null
     2024-07-30 15:15:55,336 [XNIO-1 task-195] INFO  [c.g.b.collect.service.impl.DonorInfoServiceImpl] DonorInfoServiceImpl.java:489 - 构建患者编号：[24XS019018],耗时：131
     2024-07-30 15:15:59,354 [XNIO-1 task-215] INFO  [c.g.b.c.service.impl.PreparatSampleServiceImpl] PreparatSampleServiceImpl.java:1726 - [查询上次样本信息:Start]
     2024-07-30 15:15:59,357 [XNIO-1 task-215] INFO  [c.g.b.c.t.t.s.f.TransactionRestTemplateInterceptor] TransactionRestTemplateInterceptor.java:40 - LCN-SpringCloud TxGroup info -> groupId:null
     2024-07-30 15:15:59,379 [XNIO-1 task-215] INFO  [c.g.b.c.t.t.s.f.TransactionRestTemplateInterceptor] TransactionRestTemplateInterceptor.java:40 - LCN-SpringCloud TxGroup info -> groupId:null
     2024-07-30 15:15:59,856 [XNIO-1 task-215] INFO  [c.g.b.c.service.impl.PreparatSampleServiceImpl] PreparatSampleServiceImpl.java:1734 - 获取上一次入库信息,耗时:501
     2024-07-30 15:15:59,857 [XNIO-1 task-215] INFO  [c.g.b.c.t.t.s.f.TransactionRestTemplateInterceptor] TransactionRestTemplateInterceptor.java:40 - LCN-SpringCloud TxGroup info -> groupId:null
     2024-07-30 15:16:04,551 [XNIO-1 task-215] INFO  [c.g.b.c.service.impl.PreparatSampleServiceImpl] PreparatSampleServiceImpl.java:1754 - 查询医嘱信息,耗时:4694
     2024-07-30 15:16:04,552 [XNIO-1 task-215] INFO  [c.g.b.c.service.impl.PreparatSampleServiceImpl] PreparatSampleServiceImpl.java:1785 - [查询上次样本信息:End],耗时：5198
     2024-07-30 15:16:04,993 [XNIO-1 task-208] INFO  [c.g.b.c.t.t.s.f.TransactionRestTemplateInterceptor] TransactionRestTemplateInterceptor.java:40 - LCN-SpringCloud TxGroup info -> groupId:null
     ```

## 7.31 周三 雷阵雨

### TODO：

1. 邵逸夫/登记管理/同源样本显示错误-老数据问题

   * http://10.90.12.198/storage/samplepositionrecord/query/issa/8565712261836963

   * ```bash
     2024-07-31 09:56:31,852 [XNIO-1 task-205] ERROR [c.g.b.c.s.component.GlobalExceptionHandlerResolver] GlobalExceptionHandlerResolver.java:63 - 全局异常信息 ex=null
     java.lang.NullPointerException: null
     	at com.gy.biobank.storage.service.impl.SamplePositionRecordServiceImpl.queryIsogenesisSampleList(SamplePositionRecordServiceImpl.java:602)
     	at com.gy.biobank.storage.service.impl.SamplePositionRecordServiceImpl$$FastClassBySpringCGLIB$$bf04b068.invoke(<generated>)
     	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
     	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:685)
     	at com.gy.biobank.storage.service.impl.SamplePositionRecordServiceImpl$$EnhancerBySpringCGLIB$$2e6e725b.queryIsogenesisSampleList(<generated>)
     	at com.gy.biobank.storage.controller.SamplePositionRecordController.queryIsogenesisSample(SamplePositionRecordController.java:1003)
     	at com.gy.biobank.storage.controller.SamplePositionRecordController$$FastClassBySpringCGLIB$$86694e06.invoke(<generated>)
     	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
     	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:769)
     	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
     	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
     	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:95)
     	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
     	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
     	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:689)
     	at com.gy.biobank.storage.controller.SamplePositionRecordController$$EnhancerBySpringCGLIB$$93cc45ef.queryIsogenesisSample(<generated>)
     	at sun.reflect.GeneratedMethodAccessor1378.invoke(Unknown Source)
     	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
     	at java.lang.reflect.Method.invoke(Method.java:498)
     	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:190)
     	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:138)
     	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106)
     	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:888)
     	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:793)
     	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
     	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1040)
     	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:943)
     	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
     	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)
     	at javax.servlet.http.HttpServlet.service(HttpServlet.java:503)
     	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
     	at javax.servlet.http.HttpServlet.service(HttpServlet.java:590)
     	at io.undertow.servlet.handlers.ServletHandler.handleRequest(ServletHandler.java:74)
     	at io.undertow.servlet.handlers.FilterHandler$FilterChainImpl.doFilter(FilterHandler.java:129)
     	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:320)
     	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:126)
     	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:90)
     	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334)
     	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:118)
     	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334)
     	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:137)
     	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334)
     	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:111)
     	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334)
     	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:158)
     	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334)
     	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
     	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334)
     	at org.springframework.security.oauth2.provider.authentication.OAuth2AuthenticationProcessingFilter.doFilter(OAuth2AuthenticationProcessingFilter.java:176)
     	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334)
     	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:116)
     	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334)
     	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:92)
     	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:77)
     	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
     	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334)
     	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:105)
     	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334)
     	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:56)
     	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
     	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334)
     	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:215)
     	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:178)
     	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:358)
     	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:271)
     	at io.undertow.servlet.core.ManagedFilter.doFilter(ManagedFilter.java:61)
     	at io.undertow.servlet.handlers.FilterHandler$FilterChainImpl.doFilter(FilterHandler.java:131)
     	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
     	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
     	at io.undertow.servlet.core.ManagedFilter.doFilter(ManagedFilter.java:61)
     	at io.undertow.servlet.handlers.FilterHandler$FilterChainImpl.doFilter(FilterHandler.java:131)
     	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
     	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
     	at io.undertow.servlet.core.ManagedFilter.doFilter(ManagedFilter.java:61)
     	at io.undertow.servlet.handlers.FilterHandler$FilterChainImpl.doFilter(FilterHandler.java:131)
     	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:108)
     	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
     	at io.undertow.servlet.core.ManagedFilter.doFilter(ManagedFilter.java:61)
     	at io.undertow.servlet.handlers.FilterHandler$FilterChainImpl.doFilter(FilterHandler.java:131)
     	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
     	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
     	at io.undertow.servlet.core.ManagedFilter.doFilter(ManagedFilter.java:61)
     	at io.undertow.servlet.handlers.FilterHandler$FilterChainImpl.doFilter(FilterHandler.java:131)
     	at com.gy.biobank.common.data.tenant.TenantContextHolderFilter.doFilter(TenantContextHolderFilter.java:59)
     	at io.undertow.servlet.core.ManagedFilter.doFilter(ManagedFilter.java:61)
     	at io.undertow.servlet.handlers.FilterHandler$FilterChainImpl.doFilter(FilterHandler.java:131)
     	at io.undertow.servlet.handlers.FilterHandler.handleRequest(FilterHandler.java:84)
     	at io.undertow.servlet.handlers.security.ServletSecurityRoleHandler.handleRequest(ServletSecurityRoleHandler.java:62)
     	at io.undertow.servlet.handlers.ServletChain$1.handleRequest(ServletChain.java:68)
     	at io.undertow.servlet.handlers.ServletDispatchingHandler.handleRequest(ServletDispatchingHandler.java:36)
     	at io.undertow.servlet.handlers.RedirectDirHandler.handleRequest(RedirectDirHandler.java:68)
     	at io.undertow.servlet.handlers.security.SSLInformationAssociationHandler.handleRequest(SSLInformationAssociationHandler.java:132)
     	at io.undertow.servlet.handlers.security.ServletAuthenticationCallHandler.handleRequest(ServletAuthenticationCallHandler.java:57)
     	at io.undertow.server.handlers.PredicateHandler.handleRequest(PredicateHandler.java:43)
     	at io.undertow.security.handlers.AbstractConfidentialityHandler.handleRequest(AbstractConfidentialityHandler.java:46)
     	at io.undertow.servlet.handlers.security.ServletConfidentialityConstraintHandler.handleRequest(ServletConfidentialityConstraintHandler.java:64)
     	at io.undertow.security.handlers.AuthenticationMechanismsHandler.handleRequest(AuthenticationMechanismsHandler.java:60)
     	at io.undertow.servlet.handlers.security.CachedAuthenticatedSessionHandler.handleRequest(CachedAuthenticatedSessionHandler.java:77)
     	at io.undertow.security.handlers.AbstractSecurityContextAssociationHandler.handleRequest(AbstractSecurityContextAssociationHandler.java:43)
     	at io.undertow.server.handlers.PredicateHandler.handleRequest(PredicateHandler.java:43)
     	at io.undertow.server.handlers.PredicateHandler.handleRequest(PredicateHandler.java:43)
     	at io.undertow.servlet.handlers.ServletInitialHandler.handleFirstRequest(ServletInitialHandler.java:269)
     	at io.undertow.servlet.handlers.ServletInitialHandler.access$100(ServletInitialHandler.java:78)
     	at io.undertow.servlet.handlers.ServletInitialHandler$2.call(ServletInitialHandler.java:133)
     	at io.undertow.servlet.handlers.ServletInitialHandler$2.call(ServletInitialHandler.java:130)
     	at io.undertow.servlet.core.ServletRequestContextThreadSetupAction$1.call(ServletRequestContextThreadSetupAction.java:48)
     	at io.undertow.servlet.core.ContextClassLoaderSetupAction$1.call(ContextClassLoaderSetupAction.java:43)
     	at io.undertow.servlet.handlers.ServletInitialHandler.dispatchRequest(ServletInitialHandler.java:249)
     	at io.undertow.servlet.handlers.ServletInitialHandler.access$000(ServletInitialHandler.java:78)
     	at io.undertow.servlet.handlers.ServletInitialHandler$1.handleRequest(ServletInitialHandler.java:99)
     	at io.undertow.server.Connectors.executeRootHandler(Connectors.java:376)
     	at io.undertow.server.HttpServerExchange$1.run(HttpServerExchange.java:830)
     	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
     	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
     	at java.lang.Thread.run(Thread.java:748
     ```

     ```sql
     SELECT donor_name, `status`, cb_num, create_time FROM bio_sample_position_record WHERE medical_record_no = 3543984
     
     
     
     SELECT id, donor_name, cb_num, create_time FROM bio_donor_info WHERE medical_record_no = 3543984;
     
     
     UPDATE bio_donor_info SET cb_num = 1 WHERE id = '420989002863083520'
     
     
     
     SELECT id, medical_record_no AS `病历号`, donor_name AS `患者姓名`, cb_num AS `入库次数`, create_time AS `创建时间`, district_id AS `所属院区` FROM bio_donor_info WHERE cb_num is NULL;
     ```

     

2. 信息登记/信息录入时，标本号重复

   * http://10.90.12.198/collect/transmitinfo/addInfo


3. 研发实验室-环境监控子系统流程测试

